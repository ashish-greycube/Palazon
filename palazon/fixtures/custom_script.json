[
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Order", 
  "modified": "2018-05-02 19:41:01.217461", 
  "name": "Sales Order-Client", 
  "script": "//singapore - exploded bom\nfrappe.ui.form.on(\"Sales Order\", {\n\tset_bom_amount: function(frm) {\n\t\tconsole.log(\"in\")\n\t\treturn frappe.call({\n\t\t\tmethod: \"set_items_amount\",\n\t\t\tdoc: frm.doc,\n\t\t\tcallback: function(r, rt) {\n\t\t\t\trefresh_field(\"items\");\n\t\t\t}\n\t\t});\n\t},\n\tignore_pricing_rule\t: function(frm) {\n\t\tconsole.log(\"vin\")\n\t\treturn frappe.call({\n\t\t\tmethod: \"set_items\",\n\t\t\tdoc: frm.doc,\n\t\t\tcallback: function(r, rt) {\n\t\t\t\trefresh_field(\"sales_order_detail_item\");\n\t\t\t\t// frm.doc.set_bom_amount.click();\n\t\t\t\trefresh_field(\"items\");\n\t\t\t}\n\t\t});\n\t}\n});\n//singapore - exploded bom\nfrappe.ui.form.on(\"Sales Order Item\", {\n\t//singapore - exploded bom\n\n\tbefore_items_remove:function(frm,cdt,cdn) {\n\t\tvar row = locals[cdt][cdn];\n\t\tvar child_tbl = frm.doc.sales_order_detail_item || [];\n\t\tvar child_tbl_len = child_tbl.length;\n\t\t\n\t\twhile (child_tbl_len--)\n\t\t{\n\t\t\tif((child_tbl[child_tbl_len].bom_id == row.idx))\n\t\t\t{\n\t\t\t\tcur_frm.get_field(\"sales_order_detail_item\").grid.grid_rows[child_tbl_len].remove();\n\n\t\t\t}\n\t\t}\n\t\tcur_frm.refresh();\n\t},\n\titems_remove: function(frm,cdt,cdn) {\n\t\tvar row = locals[cdt][cdn];\n\t\treturn frappe.call({\n\t\t\tmethod: \"set_items\",\n\t\t\tdoc: frm.doc,\n\t\t\tchanged_qty:0,\n\t\t\tcallback: function(r, rt) {\n\t\t\t\trefresh_field(\"sales_order_detail_item\");\n\t\t\t}\n\t\t});\n\t},\t\n\t\n\t\n\titem_code: function(frm,cdt,cdn) {\n\t\tvar row = locals[cdt][cdn];\n\t\treturn frappe.call({\n\t\t\tmethod: \"set_items\",\n\t\t\tdoc: frm.doc,\n\t\t\tchanged_qty:0,\n\t\t\tcallback: function(r, rt) {\n\t\t\t\trefresh_field(\"sales_order_detail_item\");\n\t\t\t}\n\t\t});\n\t},\n\tqty: function(frm,cdt,cdn) {\n\t\tvar row = locals[cdt][cdn];\n\t\treturn frappe.call({\n\t\t\tmethod: \"set_items\",\n\t\t\tdoc: frm.doc,\n\t\t\tchanged_qty:1,\n\t\t\tcallback: function(r, rt) {\n\t\t\t\trefresh_field(\"sales_order_detail_item\");\n\t\t\t}\n\t\t});\n\t}\t\t\n//singapore - exploded bom\n\n});\t", 
  "script_type": "Client"
 }
]